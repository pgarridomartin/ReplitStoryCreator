2:33:36 PM [express] POST /api/books/generate 400 in 9ms :: {"message":"Validation error: Story themâ€¦
Generating image with Gemini for prompt: Book cover for "Emma and the Wizard's Quest", a children's book. The main character is Emma, a girl ...
Error generating image: GoogleGenerativeAIFetchError: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent: [400 Bad Request] Multi-modal output is not supported.
    at handleResponseNotOk (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:432:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async makeRequest (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:401:9)
    at async generateContent (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:865:22)
    at async ChatSession.sendMessage (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:1203:9)
    at async generateImage (/home/runner/workspace/server/gemini.ts:59:20)
    at async generateImageWithGemini (/home/runner/workspace/server/gemini.ts:123:12)
    at async generateBookImage (/home/runner/workspace/server/openai.ts:209:12)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:42:29) {
  status: 400,
  statusText: 'Bad Request',
  errorDetails: undefined
}
Stack trace: Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent: [400 Bad Request] Multi-modal output is not supported.
    at handleResponseNotOk (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:432:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async makeRequest (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:401:9)
    at async generateContent (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:865:22)
    at async ChatSession.sendMessage (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:1203:9)
    at async generateImage (/home/runner/workspace/server/gemini.ts:59:20)
    at async generateImageWithGemini (/home/runner/workspace/server/gemini.ts:123:12)
    at async generateBookImage (/home/runner/workspace/server/openai.ts:209:12)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:42:29)
Error with image generation API: Error: Error generating image: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent: [400 Bad Request] Multi-modal output is not supported.
    at generateImage (/home/runner/workspace/server/gemini.ts:109:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async generateImageWithGemini (/home/runner/workspace/server/gemini.ts:123:12)
    at async generateBookImage (/home/runner/workspace/server/openai.ts:209:12)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:42:29)
Trying with simplified prompt: Book cover for "Emma and the Wizard's Quest", a children's book. Children's book illustration style.
Error generating image: GoogleGenerativeAIFetchError: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent: [400 Bad Request] Multi-modal output is not supported.
    at handleResponseNotOk (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:432:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async makeRequest (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:401:9)
    at async generateContent (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:865:22)
    at async ChatSession.sendMessage (file:///home/runner/workspace/node_modules/@google/generative-ai/dist/index.mjs:1203:9)
    at async generateImage (/home/runner/workspace/server/gemini.ts:59:20)
    at async generateImageWithGemini (/home/runner/workspace/server/gemini.ts:131:14)
    at async generateBookImage (/home/runner/workspace/server/openai.ts:209:12)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:42:29) {
  status: 400,
  statusText: 'Bad Request',
  errorDetails: undefined